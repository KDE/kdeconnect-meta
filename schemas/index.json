{
    "title": "Protocol Reference",
    "description": "This reference is generated from JSON Schemas used in the testing and development of KDE Connect.\n\nWe make an effort to keep this document useful, accurate and up-to-date, although it might be incomplete and it's not a formal specification.",
    "sections": [
        {
            "title": "Overview",
            "description": "There are several KDE Connect implementations (see References). They all follow the protocol described here so that they can interoperate.\n\nAt its core, the protocol works by sending JSON packets between two devices that want to communicate. KDE Connect abstracts how devices discover each other, how data is transported, or how communication is encrypted, so features can be implemented on top of the packet abstraction without worrying about the underlying details.\n\nIn most implementations of KDE Connect, the different features are written as \"plugins\" that can be enabled and disabled independently. This specification describes the packet types that the existing plugins can send and receive.\n\nPackets are sent with no guarantee that they will be received, or that if received there will be a response. For this reason, packet handling in KDE Connect is typically idempotent.\n\nPackets are sent sequentially as strings, separated by a newline character.",
            "packets": [
                "kdeconnect"
            ],
            "references": [
                "https://invent.kde.org/network/kdeconnect-kde",
                "https://invent.kde.org/network/kdeconnect-android",
                "https://invent.kde.org/network/kdeconnect-ios",
                "https://github.com/andyholmes/valent",
                "https://github.com/GSConnect/gnome-shell-extension-gsconnect/releases"
            ]
        },
        {
            "title": "Device Discovery",
            "description": "KDE Connect-enabled devices use different methods to discover each other before they can proceed to establish a connection and exchange packets. All the existing implementations support LAN discovery (for devices in the same network), while the Android and C++ implementations support Bluetooth as well. In the discovery phase, a device will send its device ID and protocol version to any other devices it can find and will establish a non-encrypted TCP connection with them.\n\nFor LAN discovery, devices listen for incoming connections on a TCP port (typically 1716) and announce their presence in the network in two ways: UDP broadcast and mDNS (Multicast DNS).",
            "subsections": [
                "discovery_udp",
                "discovery_mdns"
            ]
        },
        {
            "title": "Device Connection",
            "description": "In this phase, the devices upgrade the connection to TLS and exchange the remaining details about themselves (device name, device type and supported packet types).\n\nThe following sequence of events happens right after the discovery phase, when Device A has discovered Device B and has established a (still unencrypted) TCP connection with it:\n- Device A sends a packet with type `kdeconnect.identity` to Device B with: `deviceId`, `protocolVersion`, `targetDeviceId`, and `targetProtocolVersion`. The first two are Device A's own ID and protocol version, while the second two refer to the discovered Device B.\n- Device B verifies that the target values match their own, or otherwise aborts.\n- Both ends upgrade the connection to TLS, Device B acting as the client and Device A acting as the server. If the devices have previously paired (see Device Pairing), they will only allow the connection if the certificate is use matches the one that was stored when the devices were paired (aka certificate pinning). If they aren't paired, any certificate will be accepted (alike to SSH's Trust-On-First-Use).\n- Once the connection is secured with TLS, both devices send a packet with type `kdeconnect.identity` including their own `deviceId`, `protocolVersion`, `deviceName`, `deviceType`, `incomingCapabilities`, and `outgoingCapabilities`. If the `deviceId` or the `protocolVersion` don't match those used earlier to determine if the device is paired or not, the connection must be aborted.\n\nOnce this is done, each device has learnt about the other and can display it to the user by their name and an icon corresponding to the device type. Packets can now be exchanged between the two devices securely, although for unpaired devices all packets except pairing packets should be discarded.",
            "packets": [
                "kdeconnect.identity"
            ]
        },
        {
            "title": "Device Pairing",
            "description": "Once two devices are connected but not previously paired, the user can initiate the pairing of the two from either device. When pairing is initiated, a packet with type `kdeconnect.pair` is sent from the initiating device to the other device. The receiving device will then prompt the user to accept or reject the pairing request. If accepted, both devices will store each other's TLS certificates for future connections.\n\nThe packet exchange during pairing process is as follows:\n- Device A sends a packet with type `kdeconnect.pair` to Device B with the field `pair` set to `true` and `timestamp` sent to the current time in seconds since Epoch.\n- Device B will discard the packet if the timestamp is off by more than 30 minutes. Otherwise, it will prompt the user to accept or reject the pairing request. If the user rejects, it will send a packet with type `kdeconnect.pair` with the field `pair` set to `false`. If the user accepts, it will send a packet with type `kdeconnect.pair` with the field `pair` set to `true`.\n\nAs an additional security measure, the pairing prompt that is shown to the user may include a short authentication string calculated by getting the first 8 characters of the hexadecimal representation of the SHA256 hash of the concatenation of 3 elements: both devices' TLS public keys taken in alphabetical order and the timestamp used in the pairing as a string.\n\nA paired device can send a packet with `pair` set to `false` to unpair an already paired device.",
            "packets": [
                "kdeconnect.pair"
            ]
        },
        {
            "title": "Battery Plugin",
            "description": "The Battery plugin allows a device to expose the status of its battery.",
            "packets": [
                "kdeconnect.battery",
                "kdeconnect.battery.request"
            ],
            "references": [
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/battery",
                "https://invent.kde.org/network/kdeconnect-android/tree/master/src/org/kde/kdeconnect/Plugins/BatteryPlugin",
                "https://invent.kde.org/network/kdeconnect-ios/tree/master/KDE%20Connect/KDE%20Connect/Plugins%20and%20Plugin%20Views/Battery"
            ]
        },
        {
            "title": "Clipboard Plugin",
            "description": "The Clipboard plugin allows syncing clipboard text content between devices.",
            "packets": [
                "kdeconnect.clipboard",
                "kdeconnect.clipboard.connect"
            ],
            "references": [
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/clipboard",
                "https://invent.kde.org/network/kdeconnect-android/tree/master/src/org/kde/kdeconnect/Plugins/ClipboardPlugin",
                "https://invent.kde.org/network/kdeconnect-ios/tree/master/KDE%20Connect/KDE%20Connect/Plugins%20and%20Plugin%20Views/Clipboard"
            ]
        },
        {
            "title": "Connectivity Report Plugin",
            "description": "The Connectivity Report plugin allows a device to expose the status of its connectivity.",
            "packets": [
                "kdeconnect.connectivity_report",
                "kdeconnect.connectivity_report.request"
            ],
            "references": [
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/connectivity_report",
                "https://invent.kde.org/network/kdeconnect-android/tree/master/src/org/kde/kdeconnect/Plugins/ConnectivityReportPlugin"
            ]
        },
        {
            "title": "Contacts Plugin",
            "description": "The Contacts plugin allows devices to share contacts in vCard format.",
            "packets": [
                "kdeconnect.contacts.request_all_uids_timestamps",
                "kdeconnect.contacts.request_vcards_by_uid",
                "kdeconnect.contacts.response_uids_timestamps",
                "kdeconnect.contacts.response_vcards"
            ],
            "references": [
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/contacts",
                "https://invent.kde.org/network/kdeconnect-android/tree/master/src/org/kde/kdeconnect/Plugins/ContactsPlugin"
            ]
        },
        {
            "title": "Drawing Tablet Plugin",
            "description": "This plugin allows users to use their devices as pressure sensitive drawing tablets.",
            "packets": [
                "kdeconnect.digitizer.session",
                "kdeconnect.digitizer"
            ],
            "references": [
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/digitizer",
                "https://invent.kde.org/network/kdeconnect-android/tree/master/src/org/kde/kdeconnect/Plugins/DigitizerPlugin"
            ]
        },
        {
            "title": "FindMyPhone Plugin",
            "description": "The FindMyPhone plugin allows requesting a device to announce its location, usually by playing a sound like a traditional cordless phone.",
            "packets": [
                "kdeconnect.findmyphone.request"
            ],
            "references": [
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/findmyphone",
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/findthisdevice",
                "https://invent.kde.org/network/kdeconnect-android/tree/master/src/org/kde/kdeconnect/Plugins/FindMyPhonePlugin",
                "https://invent.kde.org/network/kdeconnect-android/tree/master/src/org/kde/kdeconnect/Plugins/FindRemoteDevicePlugin",
                "https://invent.kde.org/network/kdeconnect-ios/tree/master/KDE%20Connect/KDE%20Connect/Plugins%20and%20Plugin%20Views/FindMyPhone"
            ]
        },
        {
            "title": "Lock",
            "description": "The Lock plugin allows requesting a device to lock or unlock.",
            "packets": [
                "kdeconnect.lock",
                "kdeconnect.lock.request"
            ],
            "references": [
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/lockdevice"
            ]
        },
        {
            "title": "MousePad Plugin",
            "description": "The MousePad plugin allows remote control of the pointer and keyboard.",
            "packets": [
                "kdeconnect.mousepad.echo",
                "kdeconnect.mousepad.keyboardstate",
                "kdeconnect.mousepad.request"
            ],
            "references": [
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/mousepad",
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/remotecontrol",
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/remotekeyboard",
                "https://invent.kde.org/network/kdeconnect-android/tree/master/src/org/kde/kdeconnect/Plugins/MousePadPlugin",
                "https://invent.kde.org/network/kdeconnect-android/tree/master/src/org/kde/kdeconnect/Plugins/MouseReceiverPlugin",
                "https://invent.kde.org/network/kdeconnect-android/tree/master/src/org/kde/kdeconnect/Plugins/RemoteKeyboardPlugin",
                "https://invent.kde.org/network/kdeconnect-ios/tree/master/KDE%20Connect/KDE%20Connect/Plugins%20and%20Plugin%20Views/RemoteInput"
            ]
        },
        {
            "title": "MPRIS Plugin",
            "description": "The MPRIS plugin allows sharing control of media players.",
            "packets": [
                "kdeconnect.mpris",
                "kdeconnect.mpris.request"
            ],
            "references": [
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/mpriscontrol",
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/mprisremote",
                "https://invent.kde.org/network/kdeconnect-android/tree/master/src/org/kde/kdeconnect/Plugins/MprisPlugin",
                "https://invent.kde.org/network/kdeconnect-android/tree/master/src/org/kde/kdeconnect/Plugins/MprisReceiverPlugin"
            ]
        },
        {
            "title": "Notification Plugin",
            "description": "The Notification plugin syncs notifications between devices.",
            "packets": [
                "kdeconnect.notification",
                "kdeconnect.notification.action",
                "kdeconnect.notification.reply",
                "kdeconnect.notification.request"
            ],
            "references": [
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/notifications",
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/sendnotifications",
                "https://invent.kde.org/network/kdeconnect-android/tree/master/src/org/kde/kdeconnect/Plugins/NotificationsPlugin",
                "https://invent.kde.org/network/kdeconnect-android/tree/master/src/org/kde/kdeconnect/Plugins/ReceiveNotificationsPlugin"
            ]
        },
        {
            "title": "Ping Plugin",
            "description": "The Ping plugin allows sending and receiving simple 'pings', with an optional message. Usually these are displayed as notifications.",
            "packets": [
                "kdeconnect.ping"
            ],
            "references": [
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/ping",
                "https://invent.kde.org/network/kdeconnect-android/tree/master/src/org/kde/kdeconnect/Plugins/PingPlugin",
                "https://invent.kde.org/network/kdeconnect-ios/tree/master/KDE%20Connect/KDE%20Connect/Plugins%20and%20Plugin%20Views/Ping"
            ]
        },
        {
            "title": "Presenter Plugin",
            "description": "The Presenter plugin allows sending and receiving simple 'pings', with an optional message. Usually these are displayed as notifications.",
            "packets": [
                "kdeconnect.presenter"
            ],
            "references": [
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/presenter",
                "https://invent.kde.org/network/kdeconnect-android/tree/master/src/org/kde/kdeconnect/Plugins/PresenterPlugin",
                "https://invent.kde.org/network/kdeconnect-ios/tree/master/KDE%20Connect/KDE%20Connect/Plugins%20and%20Plugin%20Views/Presenter"
            ]
        },
        {
            "title": "RunCommand Plugin",
            "description": "The RunCommand plugin allows defining and executing remote commands.",
            "packets": [
                "kdeconnect.runcommand",
                "kdeconnect.runcommand.request"
            ],
            "references": [
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/remotecommands",
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/runcommand",
                "https://invent.kde.org/network/kdeconnect-android/tree/master/src/org/kde/kdeconnect/Plugins/RunCommandPlugin",
                "https://invent.kde.org/network/kdeconnect-ios/tree/master/KDE%20Connect/KDE%20Connect/Plugins%20and%20Plugin%20Views/RunCommand"
            ]
        },
        {
            "title": "SFTP Plugin",
            "description": "The SFTP plugin enables secure file sharing with SFTP.",
            "packets": [
                "kdeconnect.sftp",
                "kdeconnect.sftp.request"
            ],
            "references": [
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/sftp",
                "https://invent.kde.org/network/kdeconnect-android/tree/master/src/org/kde/kdeconnect/Plugins/SftpPlugin"
            ]
        },
        {
            "title": "Share Plugin",
            "description": "The Share plugin allows sharing files, text content and URLs.",
            "packets": [
                "kdeconnect.share.request",
                "kdeconnect.share.request.update"
            ],
            "references": [
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/share",
                "https://invent.kde.org/network/kdeconnect-android/tree/master/src/org/kde/kdeconnect/Plugins/SharePlugin",
                "https://invent.kde.org/network/kdeconnect-ios/tree/master/KDE%20Connect/KDE%20Connect/Plugins%20and%20Plugin%20Views/Share"
            ]
        },
        {
            "title": "SMS Plugin",
            "description": "The SMS plugin allows sending and receiving SMS/MMS messages.",
            "packets": [
                "kdeconnect.sms.attachment_file",
                "kdeconnect.sms.messages",
                "kdeconnect.sms.request",
                "kdeconnect.sms.request_attachment",
                "kdeconnect.sms.request_conversation",
                "kdeconnect.sms.request_conversations"
            ],
            "references": [
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/sms",
                "https://invent.kde.org/network/kdeconnect-android/tree/master/src/org/kde/kdeconnect/Plugins/SMSPlugin",
                "https://invent.kde.org/network/kdeconnect-android/blob/master/src/org/kde/kdeconnect/Helpers/SMSHelper.java"
            ]
        },
        {
            "title": "SystemVolume Plugin",
            "description": "The SystemVolume plugin allows sharing volume controls between devices.",
            "packets": [
                "kdeconnect.systemvolume",
                "kdeconnect.systemvolume.request"
            ],
            "references": [
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/remotesystemvolume",
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/systemvolume",
                "https://invent.kde.org/network/kdeconnect-android/tree/master/src/org/kde/kdeconnect/Plugins/SystemVolumePlugin"
            ]
        },
        {
            "title": "Telephony Plugin",
            "description": "The Telephony plugin allows notification of events such as incoming or missed calls.",
            "packets": [
                "kdeconnect.telephony",
                "kdeconnect.telephony.request_mute"
            ],
            "references": [
                "https://invent.kde.org/network/kdeconnect-kde/tree/master/plugins/telephony",
                "https://invent.kde.org/network/kdeconnect-android/tree/master/src/org/kde/kdeconnect/Plugins/TelephonyPlugin"
            ]
        }
    ]
}

